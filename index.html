<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>マラソン電卓</title>
    <!-- Tailwind CSS を読み込む -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Interフォントを設定 */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* 薄いグレーの背景 */
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-[90vh] py-2 px-4">
    <div class="bg-white p-6 rounded-lg shadow-xl w-full max-w-md border border-gray-200">
        <h1 class="text-2xl sm:text-3xl font-bold text-center mb-6 text-gray-800">マラソン電卓</h1>

        <!-- 表示エリア -->
        <div class="mb-6 bg-gray-100 p-4 rounded-md border border-gray-300">
            <div class="flex justify-between items-center mb-2">
                <span class="text-gray-600 text-lg">選択距離:</span>
                <span id="display-distance" class="text-blue-600 font-semibold text-xl">-- km</span>
            </div>
            <div class="flex justify-between items-center mb-4">
                <span class="text-gray-600 text-lg">合計時間 (分):</span>
                <input type="text" id="display-time-input" class="w-2/3 text-right text-green-700 font-bold text-3xl bg-gray-100 focus:outline-none" value="0" readonly>
            </div>
            <hr class="border-gray-300 my-4">
            <div class="text-center">
                <p class="text-gray-700 text-lg mb-2">1kmあたりのタイム:</p>
                <p id="display-pace" class="text-indigo-700 font-bold text-3xl mb-4">--:-- /km</p>
                <p class="text-gray-700 text-lg mb-2">スピード (km/h):</p>
                <p id="display-speed" class="text-red-600 font-bold text-3xl">-- km/h</p>
            </div>
        </div>

        <!-- 距離ボタン -->
        <div class="grid grid-cols-3 gap-3 mb-6">
            <button id="btn-42km" class="bg-purple-600 text-white py-3 rounded-md text-lg font-semibold hover:bg-purple-700 transition duration-200 shadow-md">
                42km (フル)
            </button>
            <button id="btn-21km" class="bg-purple-600 text-white py-3 rounded-md text-lg font-semibold hover:bg-purple-700 transition duration-200 shadow-md">
                21km (ハーフ)
            </button>
            <button id="btn-10km" class="bg-purple-600 text-white py-3 rounded-md text-lg font-semibold hover:bg-purple-700 transition duration-200 shadow-md">
                10km
            </button>
        </div>

        <!-- 数字ボタン -->
        <div class="grid grid-cols-3 gap-3">
            <button class="btn-number bg-gray-300 text-gray-800 py-3 rounded-md text-2xl font-bold hover:bg-gray-400 transition duration-200 shadow-sm">7</button>
            <button class="btn-number bg-gray-300 text-gray-800 py-3 rounded-md text-2xl font-bold hover:bg-gray-400 transition duration-200 shadow-sm">8</button>
            <button class="btn-number bg-gray-300 text-gray-800 py-3 rounded-md text-2xl font-bold hover:bg-gray-400 transition duration-200 shadow-sm">9</button>
            <button class="btn-number bg-gray-300 text-gray-800 py-3 rounded-md text-2xl font-bold hover:bg-gray-400 transition duration-200 shadow-sm">4</button>
            <button class="btn-number bg-gray-300 text-gray-800 py-3 rounded-md text-2xl font-bold hover:bg-gray-400 transition duration-200 shadow-sm">5</button>
            <button class="btn-number bg-gray-300 text-gray-800 py-3 rounded-md text-2xl font-bold hover:bg-gray-400 transition duration-200 shadow-sm">6</button>
            <button class="btn-number bg-gray-300 text-gray-800 py-3 rounded-md text-2xl font-bold hover:bg-gray-400 transition duration-200 shadow-sm">1</button>
            <button class="btn-number bg-gray-300 text-gray-800 py-3 rounded-md text-2xl font-bold hover:bg-gray-400 transition duration-200 shadow-sm">2</button>
            <button class="btn-number bg-gray-300 text-gray-800 py-3 rounded-md text-2xl font-bold hover:bg-gray-400 transition duration-200 shadow-sm">3</button>
            <button id="btn-clear" class="bg-red-500 text-white py-3 rounded-md text-xl font-bold hover:bg-red-600 transition duration-200 shadow-md">クリア</button>
            <button class="btn-number bg-gray-300 text-gray-800 py-3 rounded-md text-2xl font-bold hover:bg-gray-400 transition duration-200 shadow-sm">0</button>
            <button id="btn-calculate" class="bg-blue-500 text-white py-3 rounded-md text-xl font-bold hover:bg-blue-600 transition duration-200 shadow-md">計算</button>
        </div>
    </div>

    <script>
        // DOM要素の参照を取得
        const displayDistance = document.getElementById('display-distance');
        const displayTimeInput = document.getElementById('display-time-input');
        const displayPace = document.getElementById('display-pace');
        const displaySpeed = document.getElementById('display-speed');
        const btn42km = document.getElementById('btn-42km');
        const btn21km = document.getElementById('btn-21km');
        const btn10km = document.getElementById('btn-10km');
        const btnClear = document.getElementById('btn-clear');
        const btnCalculate = document.getElementById('btn-calculate');
        const numberButtons = document.querySelectorAll('.btn-number');

        // アプリケーションの状態を管理する変数
        let currentDistance = 0; // 選択された距離 (km)
        let inputTime = '0';     // 入力された合計時間 (分)

        /**
         * 電卓の表示を更新する関数
         */
        function updateDisplay() {
            displayDistance.textContent = currentDistance > 0 ? `${currentDistance} km` : '-- km';
            displayTimeInput.value = inputTime;

            // 距離と時間が有効な場合のみ計算して表示
            if (currentDistance > 0 && parseFloat(inputTime) > 0) {
                const totalMinutes = parseFloat(inputTime);
                const totalHours = totalMinutes / 60; // 合計時間を時間に変換

                // 1kmあたりの時間 (分/km)
                const paceMinutesPerKm = totalMinutes / currentDistance;
                const paceMinutes = Math.floor(paceMinutesPerKm); // 分の部分
                const paceSeconds = Math.round((paceMinutesPerKm - paceMinutes) * 60); // 秒の部分

                // 秒を2桁表示にフォーマット
                const formattedPaceSeconds = paceSeconds < 10 ? '0' + paceSeconds : paceSeconds;
                displayPace.textContent = `${paceMinutes}:${formattedPaceSeconds} /km`;

                // スピード (km/h)
                const speedKmh = currentDistance / totalHours;
                displaySpeed.textContent = `${speedKmh.toFixed(1)} km/h`; // 小数点以下1桁で表示
            } else {
                // 有効なデータがない場合は初期表示に戻す
                displayPace.textContent = '--:-- /km';
                displaySpeed.textContent = '-- km/h';
            }
        }

        /**
         * 数字ボタンクリック時の処理
         * @param {Event} event - クリックイベント
         */
        numberButtons.forEach(button => {
            button.addEventListener('click', (event) => {
                const digit = event.target.textContent;
                if (inputTime === '0') {
                    inputTime = digit; // 最初の入力の場合は0を置き換える
                } else {
                    inputTime += digit; // それ以外の場合は数字を追加
                }
                updateDisplay(); // 表示を更新
            });
        });

        /**
         * 距離ボタンクリック時の処理
         * @param {number} distance - 設定する距離
         */
        function setDistance(distance) {
            currentDistance = distance;
            updateDisplay(); // 表示を更新
        }

        // 距離ボタンにイベントリスナーを追加
        btn42km.addEventListener('click', () => setDistance(42.195)); // フルマラソンは正確な距離に
        btn21km.addEventListener('click', () => setDistance(21.0975)); // ハーフマラソンも正確な距離に
        btn10km.addEventListener('click', () => setDistance(10));

        /**
         * クリアボタンクリック時の処理
         */
        btnClear.addEventListener('click', () => {
            currentDistance = 0;
            inputTime = '0';
            updateDisplay(); // 表示をリセット
        });

        /**
         * 計算ボタンクリック時の処理 (現在は数字入力で自動計算されるため、明示的な計算は不要だが、ボタンは残す)
         */
        btnCalculate.addEventListener('click', () => {
            // 数字入力時に自動で計算されるため、ここでは特別な処理は不要だが、
            // ボタンが押されたことを示すために、表示を強制的に更新する
            updateDisplay();
        });

        // 初期表示を更新
        updateDisplay();
    </script>
</body>
</html>
